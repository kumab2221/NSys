# CSVNodeEditor プラグイン

NSysプラグインアーキテクチャを使用したノードプログラミング型CSV解析ツールです。

## 概要

CSVNodeEditorは、ImGui、ImNodes、ImPlotを使用して構築されたノードベースのCSVデータ解析プラグインです。直感的なドラッグ&ドロップインターフェースでCSVデータの処理フローを構築できます。

## 機能

### 基本機能
- **CSVファイルの読み込み・保存**
- **ノードベースのデータ処理フロー構築**
- **複数タブでの並列編集**
- **Dockingウィンドウ対応**

### 利用可能なノード

#### データ入力
- **CSV読み込みノード**: CSVファイルを読み込み、データを出力

#### データ処理
- **フィルターノード**: 条件に基づいてデータをフィルタリング
- **ソートノード**: 指定した列でデータをソート
- **集計ノード**: グループ化と集計関数を適用
- **結合ノード**: 複数のデータセットを結合

#### データ出力
- **CSV出力ノード**: 処理結果をCSVファイルとして保存

### UI構成

- **メニューバー**: ファイル操作、表示設定、実行制御
- **タブバー**: 複数の処理フローを管理
- **ノードパレット**: 利用可能なノードの一覧
- **プロパティパネル**: 選択されたノードの設定
- **データプレビュー**: CSVデータの内容表示
- **ログパネル**: 処理状況の表示

## プロジェクト構成

```
CSVNodeEditor/
├── external/
│   ├── imgui/          # ImGuiライブラリ（サブモジュール）
│   ├── imnodes/        # ImNodesライブラリ（サブモジュール）
│   └── implot/         # ImPlotライブラリ（サブモジュール）
├── CSVNodeEditor.h     # メインクラスヘッダー
├── CSVNodeEditor.cpp   # メインクラス実装
├── NodeEditor.h        # ノードエディタクラス
├── NodeEditor.cpp      # ノードエディタ実装
├── CSVData.h           # CSVデータ処理クラス
├── CSVData.cpp         # CSVデータ処理実装
├── NodeTypes.h         # ノードタイプ定義
├── NodeTypes.cpp       # ノードタイプ実装
├── dllmain.cpp         # DLLエントリーポイント
├── framework.h         # 共通ヘッダー
└── README.md           # このファイル
```

## ビルド方法

### 前提条件
- Visual Studio 2019以降
- Windows 10/11
- Git（サブモジュール管理用）

### ビルド手順

1. **サブモジュールの初期化**
   ```bash
   git submodule update --init --recursive
   ```

2. **Visual Studioでプロジェクトを開く**
   - `CSVNodeEditor.vcxproj`を開く
   - 設定をRelease x64に変更

3. **ビルド実行**
   - ビルド → ソリューションのビルド

4. **プラグインの配置**
   - 生成されたDLLを`x64/Release/Plugins/CSVNodeEditor/`フォルダに配置

## 使用方法

### 基本的なワークフロー

1. **CSVファイルの読み込み**
   - ノードパレットから「CSV読み込み」ノードを追加
   - ファイルパスを指定してデータを読み込み

2. **データ処理の追加**
   - 必要な処理ノード（フィルター、ソート等）を追加
   - ノード間を接続して処理フローを構築

3. **結果の出力**
   - 「CSV出力」ノードを追加
   - 出力パスを指定して結果を保存

### ノードの操作方法

- **ノードの追加**: 右クリックメニューまたはノードパレットから
- **ノードの移動**: ドラッグ&ドロップ
- **ノードの接続**: 入力/出力ピンをドラッグして接続
- **ノードの削除**: ノードを選択してDeleteキー

### タブ管理

- **新規タブ**: タブバーの「+」ボタンで作成
- **タブ切り替え**: タブをクリックして切り替え
- **タブ閉じる**: タブの「×」ボタンで閉じる

## 技術仕様

### 使用ライブラリ
- **ImGui**: Immediate Mode GUI
- **ImNodes**: ノードエディタ機能
- **ImPlot**: データ可視化

### 対応ファイル形式
- **入力**: CSV（カンマ区切り）
- **出力**: CSV（カンマ区切り）

### パフォーマンス
- 10万行程度のCSVデータを処理可能
- メモリ効率的なデータ管理

## 今後の拡張予定

- **追加ノードタイプ**
  - データ変換ノード
  - 統計分析ノード
  - 可視化ノード

- **機能拡張**
  - プロジェクトファイルの保存/読み込み
  - Undo/Redo機能
  - バッチ処理機能

- **ファイル形式対応**
  - Excelファイル対応
  - TSVファイル対応
  - JSONファイル対応

## トラブルシューティング

### よくある問題

1. **プラグインが読み込まれない**
   - DLLが正しいフォルダに配置されているか確認
   - 依存ライブラリが正しくリンクされているか確認

2. **CSVファイルが読み込めない**
   - ファイルパスが正しいか確認
   - ファイルが他のアプリケーションで開かれていないか確認

3. **ノードが表示されない**
   - ImNodesライブラリが正しく初期化されているか確認

## ライセンス

このプラグインは適切なライセンスの下で提供されています。使用する外部ライブラリのライセンスも遵守してください。

## 貢献

プロジェクトへの貢献を歓迎します。プルリクエストやイシューの報告をお気軽にお願いします。

## 参考資料

- [ImGui Documentation](https://github.com/ocornut/imgui)
- [ImNodes Documentation](https://github.com/Nelarius/imnodes)
- [ImPlot Documentation](https://github.com/epezent/implot)
- [NSys メインプロジェクト](../README.md)
